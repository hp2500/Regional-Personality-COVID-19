---
title: "Assumption Checks"
output:
  html_document:
    df_print: paged
---


# Import functions and models
```{r}

load('../Data/GER/ger_list_results_fixed_window.RData')
load('../Data/US/us_list_results_fixed_window.RData')

library(lmtest)
library(car)
library(survival)
library(tidyverse)
```

# Define Functions 
```{r}

list_iterater <- function(models, test) {
  for(i in models){
    for(j in i){
      
      if(test == 'qq'){j %>% plot(2)}
      if(test == 'ks'){j %>% resid() %>% ks.test(y=pnorm) %>% print()}
      if(test == 'bp'){j %>% bptest() %>% print()}
      if(test == 'ph'){j %>% cox.zph() %>% print()}
    }
  }
}
```


# Assumptions GER COVID-19 onsets (proportional hazards)
```{r}
list_iterater(ger_list_results$ger_cox_prev_onset, test = 'ph')
```

# Assumptions US COVID-19 onsets (proportional hazards)
```{r}
list_iterater(us_list_results$us_cox_prev_onset, test = 'ph')
```

# Assumptions GER COVID-19 growth rates (normality of residuals)
```{r}
list_iterater(ger_list_results$ger_lm_prev_slope, test = 'qq')
```

```{r}
list_iterater(ger_list_results$ger_lm_prev_slope, test = 'bp')
```

# Assumptions US COVID-19 growth rates (normality of residuals)
```{r}
list_iterater(us_list_results$us_lm_prev_slope, test = 'qq')
```

```{r}
list_iterater(us_list_results$us_lm_prev_slope, test = 'bp')
```

# Assumptions GER socdist onsets
```{r}
list_iterater(ger_list_results$ger_cox_socdist_cpt, test = 'ph')
```

# Assumptions US socdist onsets
```{r}
list_iterater(us_list_results$us_cox_socdist_cpt, test = 'ph')
```

# Assumptions GER socdist adjustment levels
```{r}
list_iterater(ger_list_results$ger_lm_socdist_mean, test = 'qq')
```

```{r}
list_iterater(ger_list_results$ger_lm_socdist_mean, test = 'bp')
```

# Assumptions US socdist adjustment levels
```{r}
list_iterater(us_list_results$us_lm_socdist_mean, test = 'qq')
```

```{r}
list_iterater(us_list_results$us_lm_socdist_mean, test = 'bp')
```
